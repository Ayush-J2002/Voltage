import pyvisa

# 1. Initialize the VISA resource manager
rm = pyvisa.ResourceManager()

# 2. Get the instrument's "address" from NI MAX
#    It will look something like this:
#    'USB0::0x1234::0x5678::SERIAL_NUM::INSTR'
#    'TCPIP::192.168.1.10::INSTR'
INSTRUMENT_ADDRESS = 'YOUR_INSTRUMENT_ADDRESS_GOES_HERE'

# 3. Find the "run program" command from the manual
#    This is just an EXAMPLE, yours will be different.
COMMAND_TO_RUN_PROGRAM = 'PROG:RUN "MY_PROGRAM"' 
#    It could also be '*TRG' or 'OUTP 1' or 'SEQ:RUN'

try:
    # Open a connection to the instrument
    print(f"Connecting to {INSTRUMENT_ADDRESS}...")
    instrument = rm.open_resource(INSTRUMENT_ADDRESS)

    # Set a timeout (good practice)
    instrument.timeout = 5000  # 5 seconds

    # Ask the instrument for its name (a good test)
    identity = instrument.query('*IDN?')
    print(f"Connected to: {identity.strip()}")

    # 4. --- THIS IS THE KEY PART ---
    #    Send the command to run your stored program
    print(f"Sending command: {COMMAND_TO_RUN_PROGRAM}")
    instrument.write(COMMAND_TO_RUN_PROGRAM)

    print("Command sent! The program should be running.")

    # Close the connection
    instrument.close()

except Exception as e:
    print(f"An error occurred: {e}")

